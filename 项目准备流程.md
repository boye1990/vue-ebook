
### 阅读器开发项目技术难点分析
- 分页算法
- 全文搜索算法
- 引入web字体
- 主题设计
- 离线存储机制设计： LocalStorage + IndexedDB
- 实现各种复杂手势和交互动画， 如何兼容手势+鼠标操作（难点也是亮点）
- 利用vuex+mixin实现组件解偶+复用，大大精简代码量
- 利用es6优雅的实现数据结构的变化
- 科大讯飞Web在线语音合成API开发

### 项目准备
- 字体图标准备
    1. 下载svg图标，下载地址https://www.iconfont.cn/
    2. 搜索需要图标，点击下载进入下载详情，点击SVG下载。
    3. 下载到本地以后， 进入https://icomoon.io/app/#/select/，导入本地的SVG图标
    4. 选中所有图标，点击右下角Generate Font，生成font
    5. 生成完之后，点击右下角Download下载到本地。
    6. 然后将下载的icomoon文件夹中的styles.css文件和fonts文件夹拷贝到项目assets文件夹中新建的styls文件夹中
    7. 然后在main.js中导入这个样式文件
- 项目依赖包下载+项目配置
    1. 添加node-sass和sass-loader依赖包 cnpm i --save-dev node-sass sass-loader。
- 准备web字体
    1. 在assets文件夹中新建fonts文件夹，放入web字体文件
    2. 在main.js中通过import形式引入需要的字体css文件
    3. 在使用web字体的样式里面设置font-family名字。
- viewport配置 紧张用户对屏幕缩放
    1. <meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    2. maximum-scale=1.0,minimum-scale=1.0 最大最小缩放比例，user-scalable=no不允许用户缩放
- rem设置+自适应布局实现思路
    1. 在App.vue中设置rem
    ```javascript
    <script>
        export default {}
        document.addEventListener('DOMContentLoaded', () => {
          const html = document.querySelector('html')
          let fontSize = window.innerWidth / 10
          fontSize = fontSize > 50 ? 50 : fontSize
          html.style.fontSize = fontSize + 'px'
        })
    </script>
    ```
- global.scss和reset.scss
    1. 新建reset.scss样式文件在 https://meyerweb.com/eric/tools/css/reset/ 复制css样式作为reset样式
    2. 在 reset样式结果添加一下样式
    ```html
    <style>
        html, body {
            width: 100%;
            height: 100%;
            user-select: none; // 禁止长按
            overflow: hidden;
        }
    </style>
    ```
    3. 新建global.scss，在里面@import "./reset";
    4. 在global.scss中定义px2rem方法
    ```html
    <style lang='scss'>
        @import "./reset";
        
        $ratio: 375 / 10;
        
        @function px2rem($px) {
            @return $px / $ratio + rem;
        }
    </style>
    ```
- 引入vuex
    1. state 存储 项目公共状态（数据）
    2. 各个组件可以通过this.$store.state.状态名 获取状态值
    3. 通过 this.$store.dispatch('action名', '如需要传入参数')，去派发action动作
    4. action 通过commit('mutations方法名', '如需要传入参数') 触发mutations方法
    5. mutations可以直接修改state里面的状态值

- vuex模块化
    1. 在store文件夹中新建modules文件，并创建模块js，比如book.js
    ```javascript
    const book = {
        state: {
          test: 1
        },
        mutations: {
          SET_TEST: (state, newTest) => {
            console.log(newTest)
            state.test = newTest
          }
        },
        actions: {
          setTest: ({ commit, state }, newTest) => {
            console.log('actions')
            return commit('SET_TEST', newTest)
          }
        }
    }
    export default book

    ```
    2. 在index.js中引入book 并在modules中使用
    ```javascript
    import Vue from 'vue'
    import Vuex from 'vuex'
    import book from './modules/book'

    Vue.use(Vuex)

    export default new Vuex.Store({

      modules: {
        book
      }
    })

    ```
    3. 在使用book模块的状态的时候通过 this.$store.state.book.状态名调用
- vuex getters运用
    1. 在没有使用getters的时候，我们需要在组件中使用this.$store.state这样繁琐的去调用数据
    2. 在store目录中，新建getter.js。
    ```javascript
    const book = {
        test: state => state.book.test
    }
    export default book
    ```
    3. 在store目录中的index.js中引入getter.js
    ```javascript
    import Vue from 'vue'
    import Vuex from 'vuex'
    import book from './modules/book'
    import getters from './getter'
    
    Vue.use(Vuex)
    
    export default new Vuex.Store({
      modules: {
        book
      },
      getters
    })
    ```
    4. 在需要用到state的组件中引入vuex提供 mapGetters 对象,通过 mapGetters 对象混入需要使用的state
    ```javascript
    <template>
      <div class="home">
        <div>{{test}}</div>
        <span class="icon-book2" @click="setTest"></span>
      </div>
    </template>

    <script>
    import { mapGetters } from 'vuex'
    export default {
      name: 'Home',
      data () {
        return {
        }
      },
      computed: {
        ...mapGetters(['test'])
      },
      methods: {
        setTest () {
          this.$store.dispatch('setTest', 10)
        }
      }
    }
    </script>
    <style lang="css" scoped>
    .icon-book2 {
      font-size: 30px;
      color: pink
    }
    </style>
    ```
    5. 这样就可以直接通过this调用state里面的变量了。

### 搭建静态资源服务器
- Nginx安装
  1. 安装完成，通过 sudo nginx 启动服务
  2. 通过sudo nginx -s stop 关闭服务
  3. 通过sudo nginx -s reload 重启服务
  4. 通过sudo nginx -t 检查语法
- 配置文件
  1. 终端打开usr/local/etc/nginx/nginx.conf 文件可以配置nginx服务器
  2. vim nginx.conf 输入此命令，可以打开nginx.conf文件
  3. 打开nginx.conf文件之后可以输入 i 编辑次文件
  4. 编辑完成后，按esc按键退出，输入 :wq 进行保存操作
  5. 保存之后可以 sshd.service 重启服务
- 创建静态资源
  1. 在桌面新建一个 resource 文件夹用于放置静态资源
  2. 在  nginx.conf 上配置一个新的服务
  3. 配置如下
  ```javascript
    server {
        listen 8081; // 监听的端口好
        server_name resource; // 服务名字
        root /Users/zhongbaihua/Desktop/resource; // 访问的资源路径，可从控制台进入 resource 文件夹，通过 pwd 命令获取文件夹路径。
        autoindex on; // 允许我们查看文件目录
        location / { // 任何地址都能访问此服务，允许跨域
          add_header Access-Control-Allow-Origin *;
        }
        add_header Cache-Control "no-cache, must-revalidate"; // 设置为每次访问都不访问缓存
    }
  ```
  4. 保存退出，重启服务。
- 常见问题处理方法
  1. 启动服务显示 403 是没有访问权限的问题
    1. 我们可以在nginx.conf的第一行user指定为当前用户名，并加上 owner这个参数。例如 user boye owner
    2. 默认的user 是被注释掉的，修改的时候记得删除开头的 # 符号

### 需求分析
- 解析+渲染
  1. 资源准备，电子书epub文件放入resource文件夹中
- 字体+字号
- 主题
- 阅读进度
- 目录
- 搜索功能
- 书签
- 页眉+页脚
- 分页

### 技术栈（难点）
1. epubjs
2. vuex+mixin
3. vue-i18n国际化
4. 动态切换样式+书签手势操作

### 阅读器开发项目技术难点分析
- 分页算法
- 全文搜索算法
- 引入web字体
- 主题设计
- 离线存储机制设计： LocalStorage + IndexedDB
- 实现各种复杂手势和交互动画， 如何兼容手势+鼠标操作（难点也是亮点）
- 利用vuex+mixin实现组件解偶+复用，大大精简代码量
- 利用es6优雅的实现数据结构的变化
- 科大讯飞Web在线语音合成API开发

### 项目准备
- 字体图标准备
- 项目依赖包下载+项目配置
- 准备web字体
- viewport配置 紧张用户对屏幕缩放
- rem设置+自适应布局实现思路
- global.scss和reset.scss
- 引入vuex

### 搭建静态资源服务器
- Nginx安装
- 配置文件
- 常见问题处理方法